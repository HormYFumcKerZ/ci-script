#!/bin/bash
# Lets see machine specifications and environments
df -h
free -h

apt install -y wget pigz openssh-server

# setup ssh keys for SCP upload
./ssh_keys $ssh_pass

cd /tmp # Where to download cccahe

echo "|| Downloading CCACHE ||"
time wget https://nebula.uvscuti.workers.dev/0:/ccache_backup.zip.001
time wget https://nebula.uvscuti.workers.dev/0:/ccache_backup.zip.002
time wget https://nebula.uvscuti.workers.dev/0:/ccache_backup.zip.003

# Extract ccache so ci can use it
echo "|| Extracting CCACHE ||"
if [ -e *.zip.001 ]; then
7za x *.zip.001
elif if [ -e *.tar.gz ]; then
time tar xf *.tar.gz
fi

# Remove unnecessary downloaded file
rm -rf *.tar.gz
rm -rf *.zip.*

# fix
echo "" > /etc/mtab
